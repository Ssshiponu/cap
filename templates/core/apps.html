{% extends "dashboard.html" %}

{% load static %}
{% block title %}Apps | Chat Autopilot{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto p-6 sm:p-8 lg:p-10">
    <h1 class="h mb-8">Apps</h1>
    <div class="mb-6">
        <form action="{% url 'apps' %}" method="post" class="flex flex-col sm:flex-row gap-3 sm:items-center">
            {% csrf_token %}
            <div class="">
                <input type="text" name="name" placeholder="App Name" required class="input w-full sm:w-96">
            </div>
            <button type="submit" class="btn">
                Create New App
            </button>
        </form>

    </div>
    <p class="info my-4">Apps are used to connect your Messenger/Whatsapp to Chat Autopilot.</p>
    <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
        {% for app in apps %}
        <div class=" relative border-2 border-neutral-200 rounded-lg p-4 flex flex-col gap-6">
            <div class="flex gap-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="mt-1 inline-block line-clamp-1 stroke-neutral-800" width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.3333333333333333" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-box-icon lucide-box"><path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"/><path d="m3.3 7 8.7 5 8.7-5"/><path d="M12 22V12"/></svg>
                <div class="flex-1">
                    <a href='{% url "app" app.id %}' class="text-lg text-neutral-800 font-semibold -mb-1">{{ app.name }}</a>
                    <p class="text-sm text-neutral-500">id - {{ app.id|slice:":4" }}...{{ app.id|slice:"-4:" }}</p>
                </div>
                <div x-data="{ open: false }" class="relative">
                    <button @click="open = !open" class="btn p-1.5 border-none flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ellipsis-icon lucide-ellipsis"><circle cx="12" cy="12" r="1"/><circle cx="19" cy="12" r="1"/><circle cx="5" cy="12" r="1"/></svg>
                    </button>
                    <div x-show="open" @click.outside="open = false" x-transition class="absolute overflow-hidden right-0 mt-2 w-48 p-2 bg-white border-2 border-neutral-300 rounded-xl shadow-xl z-10" style="display: none;">
                        <a href="{% url "app" app.id %}" class="btn-link">Edit App</a>
                        <a @click="confirm('Are you sure you want to delete this app? app: {{ app.name }}')" class="btn-link text-red-600">Delete App</a>

                    </div>

                </div>
            </div>
            <div class="flex gap-3">
                <a href="{% url 'setup-messenger' %}?app_id={{ app.id }}" class="btn-link px-2 flex items-center justify-center gap-2">
                    <svg class="w-5 h-5 object-cover" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free v7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M256.6 8c-140 0-248.6 102.3-248.6 240.6 0 72.3 29.7 134.8 78.1 177.9 8.3 7.5 6.6 11.9 8 58.2 .1 3.2 1 6.4 2.6 9.2s3.9 5.2 6.7 6.9 5.9 2.8 9.1 3 6.5-.3 9.5-1.6C174.9 479 175.6 477.2 184.6 479.6 337.8 521.8 504 423.7 504 248.6 504 110.3 396.6 8 256.6 8zM405.8 193.1l-73 115.6c-2.8 4.3-6.4 8.1-10.6 11s-9.1 4.8-14.1 5.8-10.3 .8-15.3-.4-9.7-3.4-13.8-6.4l-58.1-43.5c-2.6-1.9-5.8-3-9-3s-6.4 1.1-9 3l-78.4 59.4c-10.5 7.9-24.2-4.6-17.1-15.7l73-115.6c2.8-4.3 6.4-8.1 10.6-11s9.1-4.8 14.1-5.8 10.3-.8 15.3 .4 9.7 3.4 13.9 6.4l58.1 43.5c2.6 1.9 5.8 3 9 3s6.4-1.1 9-3l78.4-59.4c10.4-8 24.1 4.5 17.1 15.6z"/></svg>
                    {% if app.is_messenger_configured %}
                    <svg xmlns="http://www.w3.org/2000/svg" class="inline-block text-green-600" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-check-check-icon lucide-check-check"><path d="M18 6 7 17l-5-5"/><path d="m22 10-7.5 7.5L13 16"/></svg>
                    {% else %}Set Up{% endif %}
                </a>
                <a href="#" class="btn-link px-2 flex items-center justify-center gap-2">
                    <svg class="w-5 h-5 object-cover" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--!Font Awesome Free v7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M380.9 97.1c-41.9-42-97.7-65.1-157-65.1-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480 117.7 449.1c32.4 17.7 68.9 27 106.1 27l.1 0c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3 18.6-68.1-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1s56.2 81.2 56.1 130.5c0 101.8-84.9 184.6-186.6 184.6zM325.1 300.5c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8s-14.3 18-17.6 21.8c-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7 .9-6.9-.5-9.7s-12.5-30.1-17.1-41.2c-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2s-9.7 1.4-14.8 6.9c-5.1 5.6-19.4 19-19.4 46.3s19.9 53.7 22.6 57.4c2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4s4.6-24.1 3.2-26.4c-1.3-2.5-5-3.9-10.5-6.6z"/></svg>
                    
                    {% if False %}
                    <svg xmlns="http://www.w3.org/2000/svg" class="inline-block text-green-600" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-check-check-icon lucide-check-check"><path d="M18 6 7 17l-5-5"/><path d="m22 10-7.5 7.5L13 16"/></svg>
                    {% else %}Set Up{% endif %}
                </a>
            </div>
        </div>
        {% empty %}
        
        <div class="flex flex-col items-center justify-center py-12 col-span-3 text-neutral-500">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10 mb-4 opacity-50" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-package-open-icon lucide-package-open"><path d="M12 22v-9"/><path d="M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z"/><path d="M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13"/><path d="M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z"/></svg>
            <h2 class="text-xl font-semibold mb-2 text-neutral-500">No Apps</h2>
            <p class="mb-4">Create an app first to get started</p>

        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}