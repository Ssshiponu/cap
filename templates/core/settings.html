{% extends "core/dashboard.html" %}

{% block title %}Settings - {{ page.page_name }} | Chat Autopilot{% endblock title %}

{% block content %}
<div class="h-auto p-4 sm:p-6">
    <div class="flex flex-col">
        <div class="border-b border-neutral-200 p-2 pt-0">
            <h1 class="h2">Settings</h1>
        </div>
        <div class="flex-1 py-6 space-y-4">
            
            <div class="card flex items-center gap-4 p-3 pl-4">
                    <div class="flex-1 flex gap-3 items-center justify-between flex-wrap">
                    <div class="flex gap-3 items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-brain-icon lucide-brain"><path d="M12 18V5"/><path d="M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4"/><path d="M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5"/><path d="M17.997 5.125a4 4 0 0 1 2.526 5.77"/><path d="M18 18a4 4 0 0 0 2-7.464"/><path d="M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517"/><path d="M6 18a4 4 0 0 1-2-7.464"/><path d="M6.003 5.125a4 4 0 0 0-2.526 5.77"/></svg>
                        <p class="flex-1 text-nutral-800">A good system prompt will help you getting better response</p>
                        
                    </div>
                    <a class="btn-link .go">
                        Learn more
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right-icon lucide-chevron-right"><path d="m9 18 6-6-6-6"/></svg>
                    </a>
                </div>
            </div>
            <div class="text-nowrap py-5 px-6 card">
                <div class="flex items-center justify-between gap-3">
                    <div class="flex flex-col">
                        <h3 class="h3">Status</h3>
                        <p class="text-sm text-neutral-500">Pause or Active ai replies</p>
                    </div>
                    <form action="{% url "page_toggle" page.id %}?next={{ request.path }}" method="POST">
                        {% csrf_token %}
                        <div x-data="{ switchOn: {% if page.enabled %} true {% else %} false {% endif %} }" class="flex items-center justify-center space-x-3">
                            <input id="thisId" type="checkbox" name="switch" class="hidden" :checked="switchOn">

                            <button x-tooltip.left="Turn {% if page.enabled %} off {% else %} on{% endif %}"
                                x-ref="switchButton"
                                type="submit" 
                                @click="switchOn = ! switchOn"
                                :class="switchOn ? 'bg-neutral-900' : 'bg-neutral-200'" 
                                class="relative inline-flex h-4 py-[3px] ml-4 rounded-full focus:outline-none w-7"
                                x-cloak>
                                <span :class="switchOn ? 'translate-x-[15px]' : 'translate-x-[3px]'" class="w-[10px] h-[10px] duration-200 ease-in-out bg-white rounded-full"></span>
                            </button>

                        </div>
                    </form>
                </div>
                                <hr class="my-4">
                <div class="flex items-start justify-between gap-3">
                    <div class="flex flex-col">
                        <h3 class="h3">Product information</h3>
                        <p class="text-sm text-neutral-500 text-wrap">Connect woocommerce website to automatically fetch products or add products manually</p>
                    </div>

                    <div class="flex flex-col sm:flex-row gap-2">
                        <div class="relative" x-data="{ open: false }">
                            <button @click="open = ! open" class="btn p-1">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 640 640"><!--!Font Awesome Free v7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M320 72C183 72 72 183 72 320C72 457 183 568 320 568C457 568 568 457 568 320C568 183 457 72 320 72zM97 320C97 287.7 103.9 257 116.3 229.3L222.7 520.7C148.3 484.5 97 408.2 97 320zM320 543C298.1 543 277 539.8 257 533.9L323.9 339.5L392.4 527.3C392.9 528.4 393.4 529.4 394 530.4C370.9 538.5 346 543 320 543zM350.7 215.5C364.1 214.8 376.2 213.4 376.2 213.4C388.2 212 386.8 194.3 374.8 195C374.8 195 338.7 197.8 315.4 197.8C293.5 197.8 256.7 195 256.7 195C244.7 194.3 243.3 212.7 255.3 213.4C255.3 213.4 266.7 214.8 278.7 215.5L313.4 310.7L264.6 457L183.4 215.5C196.8 214.8 208.9 213.4 208.9 213.4C220.9 212 219.5 194.3 207.5 195C207.5 195 171.4 197.8 148.1 197.8C143.9 197.8 139 197.7 133.7 197.5C173.6 137 242.1 97 320 97C378 97 430.9 119.2 470.6 155.5C469.6 155.4 468.7 155.3 467.7 155.3C445.8 155.3 430.3 174.4 430.3 194.9C430.3 213.3 440.9 228.8 452.2 247.2C460.7 262 470.6 281.1 470.6 308.7C470.6 327.8 463.3 349.9 453.6 380.8L431.4 455.1L350.7 215.5zM432.1 512.7L500.2 315.8C512.9 284 517.2 258.6 517.2 235.9C517.2 227.7 516.7 220.1 515.7 213C533.1 244.8 543 281.2 543 320C543 402.3 498.4 474.1 432.1 512.7z"/></svg>
                            </button>
                            <div x-show="open" @click.outside="open = false" x-transition x-cloak class="absolute z-[10] top-10 -right-4 mt-2 w-72 bg-white border border-neutral-200 rounded-2xl shadow-lg">
                                <div class="absolute -top-2 right-6 border-l border-t rotate-45 w-4 h-4 bg-white border-neutral-200"></div>
                                <div class="p-3 text-wrap space-y-2">
                                    <div class="text-lg font-medium ml-2">Wordpress</div>
                                    <p class="text-sm text-neutral-500">Enter credentials to connect</p>
                                    <div class="space-y-1">
                                        <label for="url" class="text-sm font-medium">Wordpress website URL</label>
                                        <input type="text" id="url" name="url" class="input w-full" placeholder="e.g https://example.com">
                                    </div>

                                    <div class="space-y-1">
                                        <label for="consumer-key" class="text-sm font-medium">Consumer Key</label>
                                        <input type="text"  id="consumer-key" spellcheck="false" name="url" class="input w-full text-disk" style="-webkit-text-security: disc;">
                                    </div>
                                    <div class="space-y-1">
                                        <label for="consumer-secret" class="text-sm font-medium">Consumer Secret</label>
                                        <input type="text" id="consumer-secret" name="url" class="input w-full">
                                    </div>
                                    <div class="flex items-center justify-between gap-2 mt-4 text-sm">
                                        <button type="button" class="btn btn-danger py-1 px-3">Disconnect</button>
                                        <div class="flex gap-1">
                                            <button type="button" class="btn py-1 px-3">Cancel</button>

                                            <button type="button" class="btn py-1 px-3 btn-primary">Save</button>

                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                        
                    </div>
                    
                </div>

                <hr class="my-4">
                <form action="{% url "update_page" page.id %}?next={{ request.path }}" method="POST">
                    {% csrf_token %}
                    <div class="flex flex-col items-start justify-between gap-3" x-data="{ system_prompt: '{{ page.system_prompt|escapejs }}'}">
                        <div class="flex flex-col">
                            <h3 class="h3">System Prompt</h3>
                            <p class="text-sm text-neutral-500 text-wrap">Customize AI behavior.</p>
                        </div>
                        <textarea x-model="system_prompt" name="system_prompt" id="system_prompt" rows="8" class="input bg-neutral-50 w-full p-3"></textarea>
                        <div class="flex justify-between gap-2 w-full">
                            <p class="text-neutral-600"><span x-text="{{ settings.CREDITS_PER_REPLY }} + Math.round(countTokens(system_prompt) * {{ settings.CREDITS_PER_TOKEN }})"></span>  Credits/reply</p>
                            <button type="submit" class="btn py-1 px-3 btn-primary">Save</button>
                        </div>
                    </div>

                    <hr class="my-4">
                    <div class="flex flex-col items-start justify-between gap-3" x-data="{ business_context: '{{ page.business_context|escapejs }}'}">
                        <div class="flex flex-col">
                            <h3 class="h3">Business Context</h3>
                            <p class="text-sm text-neutral-500 text-wrap">Extra knowledge about your business or product for ai</p>
                        </div>
                        <textarea x-model="business_context" name="business_context" id="business_context" rows="8" class="input bg-neutral-50 w-full p-3"></textarea>
                        <div class="flex justify-between gap-2 w-full">
                            <p class="text-neutral-600">It doesn't cost anything</p>
                            <button type="submit" class="btn py-1 px-3 btn-primary">Save</button>
                        </div>
                    </div>
                 </form>


                
            </div>
            <div class="card">
                <div class="flex items-start justify-between gap-3">
                    <div class="flex flex-col">
                        <h3 class="h3">Reconnect page</h3>
                        <p class="text-sm text-neutral-500">Reconnect this page if you have any issues. This will not delete any data</p>
                    </div>
                    <form action="{% url "reconnect_page" page.id %}?next={{ request.path }}" method="POST">
                        {% csrf_token %}
                        <button type="submit" class="btn py-1 px-3 not-sm:p-2 flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-refresh-ccw-icon lucide-refresh-ccw"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"/><path d="M16 16h5v5"/></svg>
                            <span class="hidden sm:block">Reconnect</span>
                        </button>
                    </form>
                </div>
                <hr class="my-4">

                <div class="flex items-start justify-between gap-3">
                    <div class="flex flex-col">
                        <h3 class="h3">Delete Page</h3>
                        <p class="text-sm text-neutral-500">Delete this page from Chat Autopilot. All its data will be lost</p>

                    </div>
                    <form action="{% url "delete_page" page.id %}" method="POST" onsubmit="return confirm('Are you sure you want to delete this page? This action cannot be undone.'); ">
                        {% csrf_token %}
                        <button type="submit" class="btn py-1 px-3 not-sm:p-2 btn-danger flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trash2-icon lucide-trash-2"><path d="M10 11v6"/><path d="M14 11v6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"/><path d="M3 6h18"/><path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>
                            <span class="hidden sm:block">Delete</span>
                        </button>
                    </form>
                </div>
            </div>
            

        </div>
    </div>
</div>
{% endblock content %}

{% block scripts %}


{% endblock scripts %}