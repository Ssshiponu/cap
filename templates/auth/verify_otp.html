{% extends 'auth/base.html' %}
{% load static %}

{% block title %}Verify OTP | Chat Autopilot{% endblock %}
                
{% block heading %}Verify OTP{% endblock heading %}
{% block subheading %}Enter the OTP sent to your email{% endblock subheading %}


{% block content %}
<form action="{% url "verify_otp" %}" method="post" class="space-y-3 text-left">

    {% csrf_token %}
    <input type="hidden" name="user_id" value="{{ user_id }}">
    <input type="text" name="otp" class="input w-full" placeholder="Enter OTP">
    
    <div class="flex justify-end">
        <button type="submit" class="btn w-full">Verify</button>
    </div>

</form>
{% endblock content %}

{% block footer %}
<p class="mt-6 text-sm text-center text-neutral-500">The OTP will expire in <span id="timer">5:00</span></p>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const timer = document.getElementById('timer');
        let seconds = {{ expire_in|default:300 }};

        setInterval(function() {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            timer.textContent = `${minutes}:${String(remainingSeconds).padStart(2, '0')}`;
            if (seconds === 0) {
                location.reload();
            }
            seconds--;
        }, 1000);
    });
</script>
{% endblock footer %}