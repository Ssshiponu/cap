{% extends 'auth/base.html' %}
{% load static %}

{% block title %}Reset Password | Chat Autopilot{% endblock %}
                
{% block heading %}Reset Password{% endblock heading %}
{% block subheading %}Enter your credentials to reset your password{% endblock subheading %}


{% block content %}
<form action="{% url 'password_reset' %}" method="post" class="space-y-3 text-left">
    {% csrf_token %}
    <input type="hidden" name="token" value="{{ token }}">

    <div class="space-y-1">
        <label for="password" class="text-sm font-medium">New Password</label>
        {% include "auth/partials/password.html" with id="password" only %}
        <p class="text-xs text-neutral-500">Must be at least 8 characters</p>
    </div>

    <div class="space-y-1">
        <label for="password_confirm" class="text-sm font-medium">Confirm Password</label>
        {% include "auth/partials/password.html" with id="confirm_password" only %}
        <p id="password_match_error" class="hidden text-xs text-red-500">Passwords must match</p>
    </div>


    <button type="submit" class="btn btn-primary w-full mt-6">
        Reset Password
    </button>
</form>
<script>
    const password = document.getElementById('password')
    const confirm_password = document.getElementById('confirm_password')
    const submitButton = document.querySelector('form button[type="submit"]')

    password.addEventListener('input', checkPasswordMatch)
    confirm_password.addEventListener('input', checkPasswordMatch)

    function checkPasswordMatch() {
        if (password.value !== confirm_password.value) {
            submitButton.disabled = true
            document.getElementById('password_match_error').classList.remove('hidden')
        } else {
            submitButton.disabled = false
        }
    }

</script>
{% endblock content %}

{% block footer %}
<p class="px-8 mt-6 text-sm text-center text-neutral-500">A link will be sent to your email.</p>
<p class="mt-1 text-sm text-center text-neutral-500">You will be logged out from all devices</p>
{% endblock footer %}

